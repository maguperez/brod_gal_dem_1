{% extends 'empresa/base.html' %}
{% load staticfiles %}
{% block content %}
<script src="https://maps.googleapis.com/maps/api/js"></script>
<section class="oportunidad-detalle">
			<div class="centered">
				<div>
					<ol class="breadcrumb">
						<li class="active">{{oportunidad.titulo}}</li>
						<li>Visualizar oportunidad</li>
					</ol>
					<div class="clear"></div>
				</div>
				<div class="panel left principal">
					<div class="box">
						<header class="oportunidad-resumen">
							<img class="imagen" src="{{empresa.set_logo}}" alt="{{empresa.nombre}}" />
							<div class="detalle">
								<h1>{{oportunidad.titulo}}</h1>
								<a><h4>{{empresa.nombre | upper}}</h4></a>
								<label>{{oportunidad.ciudad}}, {{oportunidad.pais}}</label>
								<label>Remuneraci&oacute;n:
                                    {%if oportunidad.remuneracion.id == 3 %}
                                        $ {{oportunidad.remuneracion_min}}
                                    {%elif oportunidad.remuneracion.id == 2 %}
                                        $ {{oportunidad.remuneracion_min}} - {{oportunidad.remuneracion_max}}
                                    {%else%}
                                        {{oportunidad.remuneracion}}
                                    {%endif%}
                                </label>
							</div>
							<div class="postulacion">
								<a class="btn-action" href="{%url 'oportunidad-editar' oportunidad.id%}">EDITAR</a>
								<label class="cierre">CIERRA EL {{oportunidad.fecha_cese |date:"j.m.Y"}}</label>
							</div>
							<div class="clear"></div>
						</header>
						<div class="content">
							<section class="informacion">
						<h3 class="title"><i class="info"></i>{{oportunidad.titulo}}</h3>
						<div class="detalle">
							<div class = "row">
								<label class = "col-sm-3">Tipo de vacante</label>
								<div class = "col-sm-9">{{oportunidad.tipo_puesto}}</div>
								<div class="clear"></div>
							</div>
							<div class = "row">
								<label class = "col-sm-3">Jornada de trabajo</label>
								<div class = "col-sm-9">{{oportunidad.carga_horaria}}</div>
								<div class="clear"></div>
							</div>
							<div class = "row">
								<label class = "col-sm-3">Resumen</label>
								<div class = "col-sm-9"> {{oportunidad.resumen}}</div>
								<div class="clear"></div>
							</div>
						</div>
					</section>
							<section class="perfil">
						<h3 class="title"><i class="profile"></i>Perfil del candidato</h3>
						<div class="detalle">
							<div class = "row">
								<label class = "col-sm-3">Carrera</label>
								<div class = "col-sm-9">
									{% for carrera in oportunidad.carrera.all%}
									<span class="tag">{{carrera}}</span>
									{%endfor%}
								</div>
								<div class="clear"></div>
							</div>
							<div class = "row">
								<label class = "col-sm-3">Conocimientos</label>
								<div class = "col-sm-9">
									{% for conocimiento in oportunidad.conocimiento.all%}
									<span class="tag">{{conocimiento}}</span>
									{%endfor%}
								</div>
								<div class="clear"></div>
							</div>
							<div class = "row">
								<label class = "col-sm-3">Idiomas</label>
								<div class = "col-sm-9">
									{% for idioma in oportunidad.idioma.all%}
									<span class="tag">{{idioma}}</span>
									{%endfor%}
								</div>
								<div class="clear"></div>
							</div>
							<div class = "row">
								<label class = "col-sm-3">Graduaci&oacute;n / Graduaci&oacute;n estimada</label>
								<div class = "col-sm-9">2do Semestre 2015 - 2do Semestre 2016</div>
								<div class="clear"></div>
							</div>
						</div>
					</section>
							<section class="beneficios">
						<h3 class="title"><i class="like"></i>Beneficios</h3>
						<div class="detalle">
							<p>
								{% for beneficio in oportunidad.beneficio.all%}
								<span class="tag">{{beneficio}}</span>
								{%endfor%}
							<div class="clear"></div>
						</div>
					</section>
							<section class="ubicacion">
						<h3 class="title"><i class="location"></i>Ubicaci&oacute;n</h3>
						<div class="detalle">
							<div class ="form-group">
										<label class = "col-sm-3">Direcci&oacute;n</label>
										<div class = "col-sm-9" id="direccion_map">
										</div>
										<br>
									</div>
									<div class ="form-group">
										<label class = "col-sm-3"></label>
										<div class = "col-sm-3">
											<input type="hidden" id="latitud" value="{{oportunidad.latitud}}"/>
										</div>
										<div class = "col-sm-3">
                                            <input type="hidden"  id="longitud" value="{{oportunidad.longitud}}"/>
										</div>
										<div class="clear"></div>
									</div>
									<div id="map" style="height: 350px; width: 100%"></div>
						</div>
					</section>
						</div>
					</div>
				</div>
				<div class="clear"></div>
			</div>
		</section>

{% endblock %}
{%block js%}
<script>
$(function(){
	$(window).scroll(function() {
		if ( $(this).scrollTop() > 60 )
			$(".box.alcance").addClass("fixed");
		else $(".box.alcance").removeClass("fixed");
	});

{#    if($('#latitud').val() && $('#longitud').val()){#}
{#        var geocoder = new google.maps.Geocoder();#}
{##}
{#        var strLatitud = $('#latitud').val().replace(',','.');#}
{#        var strLongitud = $('#longitud').val().replace(',','.');#}
{##}
{#        var latitud = parseFloat(strLatitud);#}
{#        var longitud = parseFloat(strLongitud);#}
{#        if(latitud && longitud){#}
{#            geocoder.geocode({#}
{#            location: new google.maps.LatLng(latitud,longitud)#}
{#                }, function (response, status) {#}
{#                    if (response != null && response.length > 0 && response.status != "ZERO_RESULTS")#}
{#                        $("#direccion_map").html(response[0]["formatted_address"]);#}
{#            });#}
{#        }#}
{#    }#}

    var Ubicacion = {
        map: null,
        marca: null,
        inicializar_mapa: function () {
            var mapCanvas = document.getElementById('map');
            var mapOptions = {
                center: new google.maps.LatLng(-12.0570208,-77.0372896),
                zoom: 15,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            Ubicacion.map = new google.maps.Map(mapCanvas, mapOptions);
            if ($("#latitud").val().replace(",",".") != "" && $("#latitud").val() != "None") {
                var latitud = $("#latitud").val().replace(",",".");
                var longitud = $("#longitud").val().replace(",",".");
                var punto = new google.maps.LatLng(latitud, longitud);
                Ubicacion.marcar_mapa(punto);
            }
        },
        marcar_mapa: function (coordenadas) {
            var marker = new google.maps.Marker({
                position: coordenadas,
                map: Ubicacion.map
            });
            Ubicacion.marca = marker;

            Ubicacion.map.setCenter(coordenadas);
            var geocoder = new google.maps.Geocoder();
            geocoder.geocode({
                location: new google.maps.LatLng(coordenadas.lat(),coordenadas.lng())
                }, function (response, status) {
                    if (response != null && response.length > 0 && response.status != "ZERO_RESULTS")
                        $("#direccion_map").html(response[0]["formatted_address"]);
            });
        }
    };
    Ubicacion.inicializar_mapa();
})
</script>
{%endblock%}